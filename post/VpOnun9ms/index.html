<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>n&amp;(n-1) 特性、异或、Bitmap处理用户画像 | 云程的BLOG</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://yuncheng1998.github.io/favicon.ico?v=1619502296411">
<link rel="stylesheet" href="https://yuncheng1998.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="n&amp;(n-1) 特性
这是在一篇公众号看到的算法，主要思想为

n=n&amp;(n-1)可以消去从右到左的第一个1

这个特性可以快速解出一些二进制相关的问题诸如

判断是一个数n是否只2的幂次方，因为该数必定只有一个1，所以只需..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://yuncheng1998.github.io">
        <img src="https://yuncheng1998.github.io/images/avatar.png?v=1619502296411" class="site-logo">
        <h1 class="site-title">云程的BLOG</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      潜龙勿用
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://yuncheng1998.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">n&amp;(n-1) 特性、异或、Bitmap处理用户画像</h2>
            <div class="post-date">2021-04-11</div>
            
            <div class="post-content" v-pre>
              <h3 id="nn-1-特性">n&amp;(n-1) 特性</h3>
<p>这是在一篇公众号看到的算法，主要思想为</p>
<blockquote>
<p>n=n&amp;(n-1)可以消去从右到左的第一个1</p>
</blockquote>
<p>这个特性可以快速解出一些二进制相关的问题诸如</p>
<ul>
<li>判断是一个数n是否只2的幂次方，因为该数必定只有一个1，所以只需要判断<code>n&amp;(n-1)</code>是否为0，这样在O(1)的复杂度就可以解出</li>
<li><em>《编程之美》</em> 中求二进制中1的个数也使用了这个方法，每执行一次就可以减少一个1，最终为0时执行的次数就是1的个数</li>
</ul>
<h3 id="异或">异或</h3>
<p>和同事在讨论位运算时，同事说到用异或运算交换两个数的经典题目，由此想到了面试中被问到的道题目</p>
<blockquote>
<p>1-10万中缺失两个数，如何找到？</p>
</blockquote>
<p>如果是缺失了一个数，可以用1到10万求和减去给出数的合，或者使用1到10万异或再去异或给出的所有数，得到的就是缺失的那个数。两个数可以使用两种方法的结合，求出他们的和，再求出他们的异或，然后再有限的范围内遍历。<br>
另外还有一种方法是在 <em>《编程之美》</em> 中给出的，将给出的数异或后，由于有缺失，因此不会为0，必然有一位为1，因此可以将给出的数按照该位为1或0分为两个列表，这样缺失的两个数就会被分到两个列表中，再将1到10万按照相同的方法分到这两个列表中，这样两个列表中的数分别做异或，就求出了两个缺失的数。</p>
<h3 id="bitmap处理用户画像">Bitmap处理用户画像</h3>
<p>位图算法在处理大量数据时十分高效快捷，特别是可以与位运算结合使用，极大的提高了运算的效率。在 <em>《漫画算法》</em> 中提出了一个用户标签的问题，在刻画用户画像系统时，通常有多种标签来将用户分类，如果是通过在数据库中增加列，然后在运用SQL语句来实现查找一类用户，那么随着标签越来越多，这种方法十分低效。<br>
<em>Bitmap</em> 可以解决这一问题，位图算法的本质是利用 <em>1bit</em> 来存储一个数据，对于用户画像系统，可以使用 <em>Bitmap</em> 来存储所有的用户ID，而每个标签使用一个 <em>Bitmap</em> 来表示。<br>
假若一共有16个用户，ID为1,3和10的用户喜欢游泳，那么游泳标签 <em>SwimMap</em> 中的倒数第1位和倒数第10位为1，那么该map的值为 <code>000001000001010</code>，若ID为3,5和10的用户是学生，那么 <em>StudentMap</em> 的值为 <code>000001000101000</code></p>
<ul>
<li>要筛选喜欢游泳的学生，只需要 <code>StudentMap &amp; SwimMap</code> 即可得到 <code>000001000001000</code>，得到结果为3和10。</li>
<li>要筛选喜欢游泳或者喜欢篮球，则 <code>SwimMap | BasketBallMap</code></li>
<li>要筛选非学生，需要使用全量位图 <code>AllUserMap^StundentMap</code>，因为申请的空间必然是大于实际用户数的，因此需要维持一个全量位图，而不能简单的取非，会有很多的空用户ID。</li>
<li></li>
</ul>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://yuncheng1998.github.io/post/ffJJJTXS7/">
                  <h3 class="post-title">
                    算法周记（两数之和、整数反转、最接近的三数之和、盛水最多的容器、全排列、最长公共前缀、爬楼梯）
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
